version: "3.8"

services:
  api:
    container_name: api
    build:
      context: .
      dockerfile: Dockerfile
    expose:
      - 4000
    volumes:
      - ./serve.config.ts:/srv/api/serve.config.ts
      - ./package.json:/srv/api/package.json
      - ./tsconfig.json:/srv/api/tsconfig.json
      - ./.env:/srv/api/.env
      - ./src:/srv/api/src
    ports:
      - 4000:4000
    environment:
      - NODE_ENV=production
      - PORT=4000
    command: node --experimental-fetch .output/app.mjs
